# NumerusX - Guide de DÃ©veloppement de l'Interface Utilisateur (UI) avec React et ShadCN/UI ğŸš€

**Prompt pour l'IA**: Ta mission est de concevoir et de dÃ©velopper une interface utilisateur (UI) **exceptionnelle** pour NumerusX en utilisant React, ShadCN/UI, Tailwind CSS, Recharts, Redux, Socket.io (ou Pusher), Clerk/Auth0, et i18next. L'UI doit Ãªtre claire, moderne, minimaliste, hautement interactive, et permettre une gestion intuitive et puissante de l'application. Assure-toi de la cohÃ©rence avec les fonctionnalitÃ©s existantes et prÃ©vues du bot, et vise une expÃ©rience utilisateur (UX) de premier ordre.

## Objectifs GÃ©nÃ©raux de l'UI:

-   **ContrÃ´le CentralisÃ© et Intuitif**: DÃ©marrer, arrÃªter, configurer et surveiller le bot avec aisance.
-   **Feedback Dynamique et ComprÃ©hensible**: Afficher l'Ã©tat du bot, les logs, les actions en cours et les "pensÃ©es" de l'IA de maniÃ¨re transparente.
-   **Visualisation de DonnÃ©es AvancÃ©e**: PrÃ©senter les performances, les trades, et l'analyse de marchÃ© via des graphiques interactifs (`Recharts`), des heatmaps, et des visualisations innovantes.
-   **EsthÃ©tique Moderne et Personnalisable**: Interface Ã©purÃ©e, Ã©lÃ©gante (grÃ¢ce Ã  `ShadCN/UI` et `Tailwind CSS`), avec des options de personnalisation (thÃ¨mes, widgets).
-   **RÃ©activitÃ© et Performance**: L'interface doit Ãªtre fluide, se mettre Ã  jour dynamiquement (`Socket.io`/`Pusher` et `Redux`) sans latence perceptible, et optimisÃ©e pour les performances.
-   **SÃ©curitÃ©**: Authentification robuste avec `Clerk/Auth0`.
-   **Internationalisation (i18n)**: Prise en charge multilingue avec `i18next` et `react-i18next`.
-   **AccessibilitÃ© (A11y)**: Respecter les standards d'accessibilitÃ© (WCAG).

## Stack Technologique Frontend:

*   **Framework**: React.js (avec Vite.js pour le build)
*   **Composants UI**: ShadCN/UI
*   **Styling**: Tailwind CSS
*   **Graphiques**: Recharts (intÃ©grÃ© avec ShadCN/UI)
*   **Gestion d'Ã‰tat**: Redux (avec Redux Toolkit)
*   **Communication Temps RÃ©el**: Socket.io (prÃ©fÃ©rÃ©) ou Pusher
*   **Authentification**: Clerk ou Auth0
*   **Internationalisation**: i18next avec react-i18next
*   **Typage**: TypeScript

**Articulation des Technologies UI:**

L'interface utilisateur sera construite avec **React.js** comme bibliothÃ¨que fondamentale pour la crÃ©ation de composants interactifs. **ShadCN/UI** fournira une collection de composants d'interface utilisateur rÃ©utilisables et esthÃ©tiques, qui sont eux-mÃªmes construits sur Radix UI et stylisÃ©s avec **Tailwind CSS**. Tailwind CSS sera Ã©galement utilisÃ© pour tout stylage utilitaire personnalisÃ© nÃ©cessaire au-delÃ  des composants ShadCN/UI. Pour la visualisation de donnÃ©es, **Recharts** sera intÃ©grÃ© dans les composants React pour crÃ©er des graphiques interactifs. L'Ã©tat global de l'application, y compris les donnÃ©es temps rÃ©el provenant de Socket.io, les prÃ©fÃ©rences utilisateur (comme le thÃ¨me ou la langue via i18next), et l'Ã©tat gÃ©nÃ©ral de l'UI, sera gÃ©rÃ© par **Redux** (avec Redux Toolkit). Les composants React s'abonneront Ã  l'Ã©tat Redux (via `useSelector`) et dispatcheront des actions pour le modifier, et les donnÃ©es de cet Ã©tat (par exemple, les performances du portefeuille) seront passÃ©es comme props aux composants Recharts pour affichage.

## Structure du Projet Frontend (Exemple):

```
numerusx-ui/
â”œâ”€â”€ public/
â”‚   â””â”€â”€ locales/      # Pour les fichiers de traduction i18next
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/          # Logique Redux (store, reducers, actions)
â”‚   â”œâ”€â”€ assets/       # Images, polices, etc.
â”‚   â”œâ”€â”€ components/   # Composants React rÃ©utilisables (ShadCN/UI customisÃ©s)
â”‚   â”‚   â”œâ”€â”€ charts/   # Composants graphiques spÃ©cifiques basÃ©s sur Recharts
â”‚   â”‚   â”œâ”€â”€ layout/   # Composants de structure (Header, Sidebar, Footer)
â”‚   â”‚   â””â”€â”€ ui/       # Petits composants UI gÃ©nÃ©riques
â”‚   â”œâ”€â”€ features/     # Modules fonctionnels (Portfolio, Trading, AI Insights, etc.)
â”‚   â”‚   â””â”€â”€ Portfolio/
â”‚   â”‚       â”œâ”€â”€ components/
â”‚   â”‚       â”œâ”€â”€ PortfolioSlice.ts  # Redux slice
â”‚   â”‚       â””â”€â”€ PortfolioView.tsx
â”‚   â”œâ”€â”€ hooks/        # Hooks React customisÃ©s
â”‚   â”œâ”€â”€ lib/          # Utilitaires, helpers, config i18n, client Socket.io
â”‚   â”œâ”€â”€ pages/        # Composants de page principaux (Dashboard, Settings, Login)
â”‚   â”œâ”€â”€ services/     # Logique d'appel API backend (hors Socket.io)
â”‚   â”œâ”€â”€ styles/       # Styles globaux, config Tailwind
â”‚   â”œâ”€â”€ App.tsx
â”‚   â”œâ”€â”€ main.tsx
â”‚   â””â”€â”€ vite-env.d.ts
â”œâ”€â”€ .env
â”œâ”€â”€ .eslintrc.cjs
â”œâ”€â”€ .gitignore
â”œâ”€â”€ index.html
â”œâ”€â”€ package.json
â”œâ”€â”€ postcss.config.js
â”œâ”€â”€ tailwind.config.js
â””â”€â”€ tsconfig.json
```

## Phase 1: Initialisation du Projet Frontend et Structure de Base

-   [ ] **1.1. CrÃ©ation du Projet React avec Vite.js**:
    -   [ ] Initialiser un nouveau projet React avec TypeScript en utilisant Vite.
    -   [ ] `npm create vite@latest numerusx-ui -- --template react-ts`
-   [ ] **1.2. Installation des DÃ©pendances Initiales**:
    -   [ ] `tailwindcss`, `postcss`, `autoprefixer`
    -   [ ] `shadcn-ui` (et ses dÃ©pendances: `lucide-react`, etc.)
    -   [ ] `recharts`
    -   [ ] `redux`, `react-redux`, `@reduxjs/toolkit`
    -   [ ] `socket.io-client`
    -   [ ] `clerk-react` ou `@auth0/auth0-react`
    -   [ ] `i18next`, `react-i18next`, `i18next-http-backend`, `i18next-browser-languagedetector`
    -   [ ] `react-router-dom` pour la navigation.
-   [ ] **1.3. Configuration de Tailwind CSS**:
    -   [ ] Initialiser Tailwind CSS (`npx tailwindcss init -p`).
    -   [ ] Configurer `tailwind.config.js` et `postcss.config.js`.
    -   [ ] Importer les directives Tailwind dans `src/index.css` (ou Ã©quivalent).
-   [ ] **1.4. Initialisation de ShadCN/UI**:
    -   [ ] `npx shadcn-ui@latest init`
    -   [ ] Choisir les options de configuration (CSS variables, etc.).
    -   [ ] Ajouter quelques composants de base (`button`, `card`, `input`, `dialog`, `dropdown-menu`, `tooltip`).
-   [ ] **1.5. Configuration de Redux Store**:
    -   [ ] CrÃ©er le store Redux (`src/app/store.ts`).
    -   [ ] Mettre en place un slice initial (ex: `uiSlice` pour gÃ©rer l'Ã©tat de l'UI comme le thÃ¨me).
    -   [ ] Envelopper l'application avec le `Provider` Redux.
-   [ ] **1.6. Mise en Place de la Navigation (React Router)**:
    -   [ ] DÃ©finir les routes principales (ex: `/login`, `/dashboard`, `/settings`).
    -   [ ] CrÃ©er des composants de page placeholder pour ces routes.
    -   [ ] ImplÃ©menter la logique de routes protÃ©gÃ©es aprÃ¨s l'intÃ©gration de l'authentification.
-   [ ] **1.7. Layout Principal (Composants `Header`, `Sidebar`, `Footer`)**:
    -   [ ] CrÃ©er les composants de layout en utilisant `ShadCN/UI`.
    -   [ ] Header: Logo, titre, indicateur de statut global du bot (connectÃ© via Redux/Socket.io), menu utilisateur (accÃ¨s profil, dÃ©connexion), sÃ©lecteur de thÃ¨me.
    -   [ ] Sidebar: Navigation principale avec icÃ´nes (`lucide-react`) et labels. Collapsible.
    -   [ ] S'assurer que le layout est responsive.
-   [ ] **1.8. Internationalisation (i18n) avec i18next**:
    -   [ ] Configurer `i18next` (`src/lib/i18n.ts`).
    -   [ ] Mettre en place la dÃ©tection de langue et le chargement des traductions (ex: `en.json`, `fr.json` dans `public/locales`).
    -   [ ] Utiliser `useTranslation` hook dans quelques composants pour tester.
    -   [ ] Ajouter un sÃ©lecteur de langue dans le Header ou les Settings.
-   [ ] **1.9. Authentification (Clerk/Auth0)**:
    -   [ ] Configurer le provider Clerk/Auth0 dans `App.tsx`.
    -   [ ] CrÃ©er les pages de Login, Signup, et potentiellement un callback.
    -   [ ] ImplÃ©menter les routes protÃ©gÃ©es qui nÃ©cessitent une authentification.
    -   [ ] GÃ©rer l'Ã©tat de l'utilisateur (via Clerk/Auth0 hooks et potentiellement synchronisÃ© avec Redux).
-   [ ] **1.10. Connexion Socket.io Client**:
    -   [ ] Initialiser le client Socket.io (`src/lib/socketClient.ts`).
    -   [ ] Ã‰tablir la connexion avec le backend FastAPI (l'URL du backend sera configurable via `.env`).
    -   [ ] Mettre en place des listeners pour des Ã©vÃ©nements de test et dispatcher des actions Redux.

## Phase 1.5: IntÃ©gration Backend-Frontend (MANQUANTE)

- [ ] **1.5.1. API Endpoints Backend (FastAPI)**
    - [ ] **Objectif**: ImplÃ©menter les routes API REST nÃ©cessaires dans le backend FastAPI pour supporter les fonctionnalitÃ©s de l'UI React.
    - [ ] **Structure des Fichiers API (Suggestion)**:
        - [ ] CrÃ©er le dossier `app/api/v1/` pour regrouper les routeurs de l'API v1.
        - [ ] CrÃ©er `app/api/v1/__init__.py`.
        - [ ] ImplÃ©menter des modules routeurs spÃ©cifiques dans `app/api/v1/`:
            - [ ] `bot_routes.py`: Endpoints pour contrÃ´ler le bot (`/start`, `/stop`, `/pause`, `/status`).
            - [ ] `config_routes.py`: Endpoints pour la gestion de la configuration (`/config` GET et POST).
            - [ ] `trades_routes.py`: Endpoints pour l'historique des trades et la soumission de trades manuels (`/trades/history`, `/trades/manual`).
            - [ ] `portfolio_routes.py`: Endpoints pour les informations du portefeuille (`/portfolio/snapshot`, `/portfolio/positions`).
            - [ ] `ai_decisions_routes.py`: Endpoints pour l'historique des dÃ©cisions de l'IA et leur raisonnement (`/ai/decisions/history`, `/ai/decisions/{decision_id}/reasoning`).
            - [ ] `system_routes.py`: Endpoints pour la santÃ© du systÃ¨me et les logs (`/system/health`, `/system/logs`).
    - [ ] **IntÃ©gration dans `app/main.py`**: Inclure ces routeurs dans l'application FastAPI principale.
    - [ ] **ModÃ¨les Pydantic**: DÃ©finir des modÃ¨les Pydantic pour les requÃªtes et les rÃ©ponses de ces endpoints pour assurer la validation et la documentation automatique (Swagger/OpenAPI).

- [ ] **1.5.2. Middleware et SÃ©curitÃ© Backend (FastAPI)**
    - [ ] **Objectif**: Mettre en place les middlewares FastAPI nÃ©cessaires pour la sÃ©curitÃ©, la journalisation et la gestion des requÃªtes.
    - [ ] **DÃ©tails**:
        - [ ] **Middleware JWT**: CrÃ©er un middleware FastAPI (ou utiliser des dÃ©pendances FastAPI) pour valider les tokens JWT (provenant de Clerk/Auth0) sur les endpoints API protÃ©gÃ©s et sur la connexion Socket.io (lors du handshake initial).
        - [ ] **Rate Limiting**: ImplÃ©menter un rate limiter (ex: avec `fastapi-limiter` et Redis) sur les endpoints API pour prÃ©venir les abus.
        - [ ] **CORS**: Configurer le middleware CORS (`CORSMiddleware`) dans FastAPI pour autoriser les requÃªtes provenant du domaine du frontend React.
        - [ ] **Middleware de Logging des RequÃªtes**: Mettre en place un middleware pour journaliser les dÃ©tails de chaque requÃªte API reÃ§ue (mÃ©thode, chemin, statut, temps de rÃ©ponse).

## Phase 1.6: Configuration Build et DÃ©ploiement

- [ ] **1.6.1. Configuration Vite pour production**
    - [ ] Configurer vite.config.ts pour optimisation build
    - [ ] Ajouter variables d'environnement pour diffÃ©rents environnements
    - [ ] Configurer proxy pour dÃ©veloppement local
    - [ ] Optimiser les imports pour rÃ©duire bundle size

- [ ] **1.6.2. Scripts NPM**
    - [ ] Script dev pour dÃ©veloppement avec HMR
    - [ ] Script build pour production
    - [ ] Script preview pour test build local
    - [ ] Script type-check pour validation TypeScript

## Phase 2: DÃ©veloppement des FonctionnalitÃ©s de l'UI par Panneau

*Pour chaque panneau, crÃ©er un rÃ©pertoire dÃ©diÃ© dans `src/features/` avec ses propres composants, slice Redux si nÃ©cessaire, et vue principale.*

### Ã‰tape 2.1: Panneau "Portfolio Overview"
-   [ ] **Affichage de la Valeur Totale du Portefeuille**:
    -   [ ] Label principal clair et visible, mis Ã  jour en temps rÃ©el via Redux/Socket.io.
    -   [ ] "Sparkline" (`Recharts`) Ã  cÃ´tÃ© de la valeur totale montrant la tendance rÃ©cente.
    -   [ ] Variation sur 24h, 7j, 30j (avec sÃ©lecteur `Tabs` de ShadCN/UI).
-   [ ] **Graphique d'Allocation d'Actifs Interactif (`Recharts`)**:
    -   [ ] `PieChart` (Donut) ou `Treemap` (si Recharts le supporte bien, sinon simuler avec des `div`s).
    -   [ ] Afficher les allocations par actif, avec tooltips interactifs.
-   [ ] **Graphique de Performance du Portefeuille (`Recharts`)**:
    -   [ ] `LineChart` ou `AreaChart` pour l'Ã©volution de la valeur du portefeuille.
    -   [ ] SÃ©lecteur de pÃ©riode.
    -   [ ] Superposition d'Ã©vÃ©nements clÃ©s (via Redux).
-   [ ] **Tableau des Positions ("Holdings") (`ShadCN/UI Table`)**:
    -   [ ] Colonnes: Actif (logo + symbole), QuantitÃ©, Prix d'Achat Moyen, Prix Actuel, Valeur Totale, P&L Non RÃ©alisÃ© (montant et %), Variation 24h (%).
    -   [ ] DonnÃ©es mises Ã  jour en temps rÃ©el.
    -   [ ] Actions par ligne (menu contextuel `DropdownMenu`).
-   [ ] **Indicateurs de Risque du Portefeuille**:
    -   [ ] Afficher Sharpe Ratio, Sortino Ratio (calculÃ©s cÃ´tÃ© backend, transmis via API/Socket).

### Ã‰tape 2.2: Panneau "Trading Activity Center"
-   [ ] **Tableau des Trades RÃ©cents (`ShadCN/UI Table`)**:
    -   [ ] Colonnes: Paire, Type (Achat/Vente), Montant, Prix, Slippage, Frais, Statut, Raison du Trade (IA/Manuel), Timestamp.
    -   [ ] Cliquer pour voir dÃ©tails (`Dialog` ShadCN/UI) avec snapshot des indicateurs et raisonnement IA.
-   [ ] **Analyse de Performance des Trades**:
    -   [ ] Affichage: Taux de rÃ©ussite, Profit Factor.
    -   [ ] `BarChart` (`Recharts`) pour la distribution des P&L.
-   [ ] **Visualisation des Ordres Actifs (Limites, DCA)**:
    -   [ ] Tableau des ordres ouverts avec possibilitÃ© d'annulation.

### Ã‰tape 2.3: Panneau "Market Intelligence Hub"
-   [ ] **Indicateur Global de Sentiment de MarchÃ©**:
    -   [ ] Visualisation type "gauge" (peut Ãªtre custom avec `Recharts` ou un composant SVG) ou `Progress` ShadCN/UI.
-   [ ] **Watchlist Dynamique et Interactive (`ShadCN/UI Card`s ou `Table`)**:
    -   [ ] Tokens avec signaux forts (BUY/SELL) de l'IA.
    -   [ ] Raisons du signal, mini-graphiques (`Recharts Sparklines`).
-   [ ] **Graphiques de Prix Interactifs (`Recharts`)**:
    -   [ ] `LineChart` ou `AreaChart` pour les prix, chandeliers si Recharts le permet facilement (sinon, une bibliothÃ¨que plus spÃ©cialisÃ©e pourrait Ãªtre envisagÃ©e pour les chandeliers).
    -   [ ] Superposition des prÃ©dictions de prix de l'IA.
    -   [ ] Annotations pour les dÃ©cisions IA.
-   [ ] **Section "AI Insights"**:
    -   [ ] Flux de "pensÃ©es" ou d'observations clÃ©s de l'IA, reÃ§ues via Socket.io.

### Ã‰tape 2.4: Panneau "Command & Control Center"
-   [ ] **ContrÃ´le du Bot**:
    -   [ ] Boutons Start/Stop/Pause (`Button` ShadCN/UI) envoyant des commandes via Socket.io.
    -   [ ] Mode "Safe" (Paper Trading) vs "Live" (SÃ©lecteur `Switch` ou `RadioGroup`).
    -   [ ] Indicateur visuel du cycle du bot.
-   [ ] **Gestion Fine des StratÃ©gies**:
    -   [ ] SÃ©lecteur de stratÃ©gie active (`Select` ShadCN/UI).
    -   [ ] Affichage des paramÃ¨tres de la stratÃ©gie.
    -   [ ] Interface pour ajuster les paramÃ¨tres (avec `Input`, `Slider`).
-   [ ] **Formulaire d'EntrÃ©e Manuelle de Trade**:
    -   [ ] Inputs pour paire, montant, type d'ordre.
    -   [ ] Affichage du solde disponible, estimation des frais.
    -   [ ] Bouton d'exÃ©cution.

### Ã‰tape 2.5: Panneau "System Health & Operations"
-   [ ] **SantÃ© des Composants et Connexions**:
    -   [ ] Indicateurs (`Badge` ShadCN/UI avec couleurs) pour Backend API, WebSocket, `MarketDataProvider`, `TradingEngine`, `Database`, `JupiterApiClient`, `GeminiClient`.
    -   [ ] DonnÃ©es reÃ§ues via Socket.io.
-   [ ] **MÃ©triques d'Utilisation des Ressources du Backend**:
    -   [ ] CPU, RAM (si le backend les expose).
-   [ ] **Visualisation des Logs IntÃ©grÃ©e**:
    -   [ ] Panneau affichant les logs en temps rÃ©el (Socket.io).
    -   [ ] Filtres (niveau, module), recherche.

### Ã‰tape 2.6: Panneau "Settings & Customization"
-   [ ] **Ã‰diteur des ParamÃ¨tres de `Config` du Bot**:
    -   [ ] Formulaire groupÃ© par catÃ©gorie (Trading, API, AI, Notifications).
    -   [ ] Sauvegarde via appel API au backend.
-   [ ] **ParamÃ¨tres de Notification UI**:
    -   [ ] Activer/dÃ©sactiver les notifications de l'UI.
-   [ ] **Gestion du Profil Utilisateur (via Clerk/Auth0)**.
-   [ ] **SÃ©lecteur de Langue (i18next)**.
-   [ ] **SÃ©lecteur de ThÃ¨me (Light/Dark/System)**:
    -   [ ] Utiliser le support de thÃ¨me de Tailwind/ShadCN/UI.
    -   [ ] Stocker la prÃ©fÃ©rence dans `localStorage` et Redux.

## Phase 3: AmÃ©liorations GÃ©nÃ©rales, Tests et DÃ©ploiement

-   [ ] **3.1. RÃ©activitÃ© Mobile et Tablette (Optimisation Finale)**.
-   [ ] **3.2. Tests**:
    -   [ ] Tests unitaires pour les composants critiques et la logique Redux (avec Jest/React Testing Library).
    -   [ ] Tests d'intÃ©gration pour les flux utilisateurs clÃ©s.
    -   [ ] Tests E2E (optionnel, avec Playwright ou Cypress).
-   [ ] **3.3. Optimisation des Performances**:
    -   [ ] `React.memo`, `useCallback`, `useMemo`.
    -   [ ] Code splitting (Vite gÃ¨re cela en partie).
    -   [ ] Optimisation des rendus Redux.
-   [ ] **3.4. Gestion des Erreurs dans l'UI**:
    -   [ ] Composant `ErrorBoundary` global.
    -   [ ] Notifications `Toast` (ShadCN/UI) pour les erreurs.
-   [ ] **3.5. AccessibilitÃ© (A11y Review)**.
-   [ ] **3.6. Documentation Frontend**:
    -   [ ] Documenter la structure du projet, les dÃ©cisions d'architecture clÃ©s, et comment lancer/dÃ©velopper l'UI.
-   [ ] **3.7. Build de Production**:
    -   [ ] Configurer le script `build` dans `package.json` (`vite build`).
-   [ ] **3.8. Dockerisation de l'UI**:
    -   [ ] CrÃ©er un `Dockerfile` pour l'application React (multi-stage build avec Nginx pour servir les fichiers statiques).
    -   [ ] Mettre Ã  jour `docker-compose.yml` pour inclure le service frontend.

## Phase 4: Interaction Backend (FastAPI) <-> Frontend (React)

Cette section dÃ©taille la communication entre le backend FastAPI et le frontend React, principalement via Socket.io pour les donnÃ©es temps rÃ©el et les API REST pour les actions initiÃ©es par l'utilisateur.

### 4.1. Communication via Socket.io

Le client Socket.io dans React (`src/lib/socketClient.ts`) se connectera au serveur Socket.io gÃ©rÃ© par FastAPI.

-   **Ã‰vÃ©nements Ã‰mis par le Backend (Exemples) et Gestion par Redux (Frontend)**:
    -   `connect`: Ã‰mis lors de la connexion initiale. Le frontend peut mettre Ã  jour un Ã©tat `isConnected` dans un slice Redux (ex: `systemSlice`).
    -   `disconnect`: Ã‰mis lors de la dÃ©connexion. Mettre Ã  jour `isConnected`.
    -   `bot_status_update`:
        -   **Payload**: `{ "status": "RUNNING" | "STOPPED" | "PAUSED" | "ERROR", "current_cycle": 123, "next_cycle_in_sec": 60, "error_message": "Optional error string" }`
        -   **Action Redux**: `dispatch(systemSlice.actions.setBotStatus(payload))`
        -   **Impact UI**: Mise Ã  jour des indicateurs de statut dans le Header et le "Command & Control Center".
    -   `portfolio_update`:
        -   **Payload**: `{ "total_value_usd": 12345.67, "pnl_24h_usd": 150.0, "positions": [{"asset": "SOL", "amount": 10.5, "avg_buy_price": 150.0, "current_price": 165.0, "value_usd": 1732.5}], "available_cash_usdc": 4000.0 }`
        -   **Action Redux**: `dispatch(portfolioSlice.actions.updatePortfolio(payload))`
        -   **Impact UI**: Mise Ã  jour des graphiques Recharts et des tableaux dans "Portfolio Overview".
    -   `new_trade_executed`:
        -   **Payload**: `{ "trade_id": "uuid", "pair": "SOL/USDC", "type": "BUY", "amount_tokens": 1.0, "price_usd": 165.0, "timestamp_utc": "...", "status": "FILLED", "reason_source": "AI_AGENT" | "MANUAL", "ai_reasoning_id": "optional_uuid_to_fetch_reasoning" }`
        -   **Action Redux**: `dispatch(tradesSlice.actions.addRecentTrade(payload))`
        -   **Impact UI**: Ajout Ã  la table des trades dans "Trading Activity Center".
    -   `ai_agent_decision`:
        -   **Payload**: `{ "decision_id": "uuid", "decision": "BUY" | "SELL" | "HOLD", "token_pair": "SOL/USDC", "confidence": 0.85, "reasoning_snippet": "RSI bullish, MACD crossover.", "timestamp_utc": "...", "full_prompt_id": "optional_uuid_to_fetch_prompt", "key_inputs_summary": { ... } }`
        -   **Action Redux**: `dispatch(aiAgentSlice.actions.newAiDecision(payload))`
        -   **Impact UI**: Affichage dans le flux "AI Insights" ou mise Ã  jour d'un log de dÃ©cisions.
    -   `market_data_update`:
        -   **Payload**: `{ "pair": "SOL/USDC", "current_price": 165.30, "volume_24h_usd": 1200000000, "sentiment_score": 0.65 }` (peut Ãªtre plus granulaire par token ou global)
        -   **Action Redux**: `dispatch(marketSlice.actions.updateMarketData(payload))`
        -   **Impact UI**: Mise Ã  jour des graphiques de prix, indicateurs de sentiment dans "Market Intelligence Hub".
    -   `system_health_update`:
        -   **Payload**: `{ "service_name": "JupiterApiClient", "status": "OPERATIONAL" | "DEGRADED" | "ERROR", "last_error": "Optional error message"}` (un Ã©vÃ©nement par service ou un snapshot global)
        -   **Action Redux**: `dispatch(systemSlice.actions.updateServiceHealth(payload))`
        -   **Impact UI**: Mise Ã  jour des badges de statut dans "System Health & Operations".
    -   `new_log_entry`:
        -   **Payload**: `{ "level": "INFO" | "WARNING" | "ERROR", "module": "TradingEngine", "message": "Swap executed successfully.", "timestamp_utc": "..." }`
        -   **Action Redux**: `dispatch(logsSlice.actions.addLogEntry(payload))`
        -   **Impact UI**: Ajout Ã  la visualisation des logs.
-   **Actions InitiÃ©es par le Frontend (Exemples)**:
    -   L'UI peut Ã©mettre des Ã©vÃ©nements Socket.io vers le backend pour des actions de contrÃ´le directes (ex: `start_bot`, `stop_bot`, `adjust_strategy_params`). Le backend confirmera ces actions via un Ã©vÃ©nement de retour ou un `bot_status_update`.

### 4.2. Communication via API REST (pour actions et configurations)

Les API REST seront utilisÃ©es pour les actions qui ne nÃ©cessitent pas une communication bidirectionnelle constante ou pour rÃ©cupÃ©rer des ensembles de donnÃ©es initiaux.

-   **SÃ©curisation**: Tous les endpoints API et la connexion Socket.io (via le handshake initial) seront sÃ©curisÃ©s en utilisant des tokens JWT fournis par Clerk/Auth0. Le backend validera ces tokens.
-   **Exemples d'Endpoints FastAPI (et Actions Redux correspondantes si nÃ©cessaire)**:
    -   `POST /api/v1/bot/start`: DÃ©marre le bot.
        -   **Action Redux (Optimiste)**: `dispatch(systemSlice.actions.setBotStatus({ status: "STARTING" }))` en attendant la confirmation via Socket.io.
    -   `POST /api/v1/bot/stop`: ArrÃªte le bot.
    -   `POST /api/v1/bot/pause`: Met le bot en pause.
    -   `GET /api/v1/config`: RÃ©cupÃ¨re la configuration actuelle du bot pour affichage/Ã©dition dans le panneau "Settings".
    -   `POST /api/v1/config`: Met Ã  jour la configuration du bot.
        -   NÃ©cessite une validation rigoureuse cÃ´tÃ© backend.
    -   `POST /api/v1/trades/manual`: Permet Ã  l'utilisateur de soumettre un ordre manuel.
        -   Le backend valide et transmet au `TradeExecutor`.
    -   `GET /api/v1/trades/history?limit=50&offset=0`: RÃ©cupÃ¨re l'historique des trades pour affichage paginÃ©.
    -   `GET /api/v1/ai/decisions/history?limit=50&offset=0`: RÃ©cupÃ¨re l'historique des dÃ©cisions de l'IA.
    -   `GET /api/v1/portfolio/snapshot`: RÃ©cupÃ¨re un snapshot complet du portefeuille (utile pour le chargement initial de l'UI).

### 4.3. Structure des Slices Redux (Exemple `portfolioSlice.ts`)

BasÃ© sur la structure suggÃ©rÃ©e dans `src/features/Portfolio/PortfolioSlice.ts`:

```typescript
// src/features/Portfolio/PortfolioSlice.ts
import { createSlice, PayloadAction } from '@reduxjs/toolkit';

interface Position {
  asset: string;
  amount: number;
  avg_buy_price: number;
  current_price: number;
  value_usd: number;
}

interface PortfolioState {
  total_value_usd: number;
  pnl_24h_usd: number;
  positions: Position[];
  available_cash_usdc: number;
  isLoading: boolean;
  lastUpdated: string | null;
}

const initialState: PortfolioState = {
  total_value_usd: 0,
  pnl_24h_usd: 0,
  positions: [],
  available_cash_usdc: 0,
  isLoading: true,
  lastUpdated: null,
};

const portfolioSlice = createSlice({
  name: 'portfolio',
  initialState,
  reducers: {
    setPortfolioLoading: (state, action: PayloadAction<boolean>) => {
      state.isLoading = action.payload;
    },
    updatePortfolio: (state, action: PayloadAction<Partial<PortfolioState>>) => {
      // Merge new data with existing state
      Object.assign(state, action.payload);
      state.isLoading = false;
      state.lastUpdated = new Date().toISOString();
    },
    // Potentially actions for optimistic updates or specific position changes
  },
});

export const { setPortfolioLoading, updatePortfolio } = portfolioSlice.actions;
export default portfolioSlice.reducer;
```

Des slices similaires seraient crÃ©Ã©s pour `tradesSlice`, `aiAgentSlice`, `marketSlice`, `systemSlice`, `logsSlice`, etc., chacun gÃ©rant sa partie de l'Ã©tat global de l'application et rÃ©pondant aux Ã©vÃ©nements Socket.io ou aux rÃ©sultats d'appels API.

Les composants React (notamment ceux utilisant `Recharts`) s'abonneraient Ã  ces slices Redux via le hook `useSelector` pour obtenir les donnÃ©es nÃ©cessaires et se rÃ©afficher lorsque l'Ã©tat change.

## Sources de DonnÃ©es pour l'UI (via API Backend FastAPI & Socket.io):

Le frontend communiquera avec le backend FastAPI :
1.  **API RESTful**: Pour les actions (ex: sauvegarder les settings, initier un trade manuel) et la rÃ©cupÃ©ration de donnÃ©es initiales/historiques.
2.  **Socket.io**: Pour les mises Ã  jour en temps rÃ©el (prix, Ã©tat du bot, P&L, logs, dÃ©cisions IA, santÃ© des systÃ¨mes).

Ce guide est un point de dÃ©part. L'IA devra faire preuve d'initiative pour proposer des solutions Ã©lÃ©gantes et efficaces pour chaque fonctionnalitÃ©, en tirant parti au mieux de la stack technologique choisie. 